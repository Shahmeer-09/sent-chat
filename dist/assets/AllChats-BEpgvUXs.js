import{u as ie,r as u,a as de,g as xe,c as ee,f as me,j as e,A as he,b as g,G as B,R as pe,d as ue,e as ne,h as Z,S as K,i as re,U as Q,k as ge,l as fe,m as se,n as je,o as q,F as ve,p as D,q as I,s as T,t as W,v as $,w as te,x as J,y as Ne,C as A,B as w,z as R,D as Ce,E as be,H as _e}from"./index-D7C9LgLM.js";function we(s){const r=Object.assign({},s);for(let l in r)r[l]===void 0&&delete r[l];return r}function ze(s={}){const{as:r,ref:l,max:t=5,total:m,size:c,color:h,radius:o,children:d,isBordered:p,isDisabled:y,isGrid:f,renderCount:j,className:S,classNames:C,...O}=s,k=ie(l),L=r||"div",U=u.useMemo(()=>({size:c,color:h,radius:o,isGrid:f,isBordered:p,isDisabled:y}),[c,h,o,f,p,y]),G=u.useMemo(()=>de({className:S,isGrid:f}),[S,f]),v=xe(d),_=t?v.slice(0,t):v,M=m||(t!=null?v.length-t:-1),P=_.map((V,F)=>{const E=F===0,H=F===_.length-1,n={className:ee(E?"ms-0":f?"":"-ms-2",H&&M<1?"hover:-translate-x-0":"")};return u.cloneElement(V,we(n))});return{Component:L,context:U,remainingCount:M,clones:P,renderCount:j,getAvatarGroupProps:()=>({ref:k,className:G.base({class:ee(C==null?void 0:C.base,S)}),role:"group",...O}),getAvatarGroupCountProps:()=>({className:G.count({class:C==null?void 0:C.count})})}}var ce=me((s,r)=>{const{Component:l,clones:t,context:m,remainingCount:c,getAvatarGroupCountProps:h,getAvatarGroupProps:o,renderCount:d=p=>e.jsx(g,{...h(),name:`+${p}`})}=ze({...s,ref:r});return e.jsx(l,{...o(),children:e.jsxs(he,{value:m,children:[t,c>0&&d(c)]})})});ce.displayName="NextUI.AvatarGroup";var ye=ce;const Se=()=>e.jsx("div",{className:" bg-gradient-to-r  from-cyan-500 to-yellow-400  rounded-full h-[40px] w-[40px]    "});function ke(s){return B({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15.5 5C13.567 5 12 6.567 12 8.5C12 10.433 13.567 12 15.5 12C17.433 12 19 10.433 19 8.5C19 6.567 17.433 5 15.5 5ZM10 8.5C10 5.46243 12.4624 3 15.5 3C18.5376 3 21 5.46243 21 8.5C21 9.6575 20.6424 10.7315 20.0317 11.6175L22.7071 14.2929L21.2929 15.7071L18.6175 13.0317C17.7315 13.6424 16.6575 14 15.5 14C12.4624 14 10 11.5376 10 8.5ZM3 4H8V6H3V4ZM3 11H8V13H3V11ZM21 18V20H3V18H21Z"},child:[]}]})(s)}function Ge(s){return B({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(s)}function ae(s){return B({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(s)}const Me=({user:s,CreateChat:r})=>e.jsxs("div",{onClick:()=>r(s._id),className:" flex rounded-2xl cursor-pointer  hover:scale-105 transition-all  h-10  items-center  p-1 mb-b sm:mx-0  bg-zinc-200  text-zinc-800  ",children:[e.jsx(g,{className:" w-8  h-8 ",src:(s==null?void 0:s.profilepic)||"https://i.pravatar.cc/150?u=a042581f4e29026024d"}),e.jsx("div",{className:" flex flex-col ",children:e.jsxs("span",{className:" font-semibold mx-2 text-sm ",children:[(s==null?void 0:s.name)||(s==null?void 0:s.email)," "]})})]}),le=pe({key:"allchats",default:[]}),Ae=({user:s,handlselected:r})=>e.jsxs("div",{onClick:r,className:" flex rounded-2xl cursor-pointer w-[200px]  hover:scale-105 transition-all  h-8  items-center  p-1 mb-b sm:mx-0  bg-zinc-200  text-zinc-800  ",children:[e.jsx(g,{className:" w-6  h-6 ",src:(s==null?void 0:s.profilepic)||"https://i.pravatar.cc/150?u=a042581f4e29026024d"}),e.jsx("div",{className:" flex flex-col ",children:e.jsx("span",{className:" font-semibold mx-2 text-sm ",children:s==null?void 0:s.name})})]}),Le=()=>{const s=ue(),{isOpen:r,onOpen:l,onOpenChange:t,onClose:m}=ne(),[c,h]=u.useState([]),[o,d]=u.useState(""),[p,y]=u.useState(""),[f,j]=u.useState(!1),[S,C]=Z(K),O=re(Q),[k,L]=Z(le),[U,G]=u.useState(!1),[v,_]=u.useState([]),[M,P]=u.useState("");u.useRef("");const X=async n=>{var a,x,b;j(!0);try{const i=await A.post("/auth/search",{search:o});h((a=i.data)==null?void 0:a.data),j(!1),y("")}catch(i){y(((b=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:b.message)||i.message),j(!1),h([])}};u.useEffect(()=>{const n=setTimeout(()=>{X()},1e3);return()=>{clearTimeout(n)}},[o]);const Y=async n=>{var a,x,b;try{const z=await((a=(await A.post("/chat/createChat",{userId:n})).data)==null?void 0:a.data);k.find(N=>N._id===z[0]._id)||L([z[0],...k]),C(z[0]),console.log(S),m(),d(""),_([])}catch(i){w.error(((b=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:b.message)||i.message)}},V=n=>{if(v.find(a=>a._id===n._id)){w.error("User already added");return}_([n,...v])},F=n=>{_(v.filter(a=>a._id!=n._id))},E=async()=>{var n,a,x,b,i,z;j(!0);try{const N=await A.post("/chat/createGroup",{chatname:M,users:v.map(oe=>oe._id)});console.log((n=N.data)==null?void 0:n.data),w.success((a=N.data)==null?void 0:a.message),j(!1),_([]),P(""),d(""),L([(x=N.data)==null?void 0:x.data,...k]),C((b=N.data)==null?void 0:b.data),m()}catch(N){w.error(((z=(i=N==null?void 0:N.response)==null?void 0:i.data)==null?void 0:z.message)||N.message),j(!1)}},H=()=>{var n,a;j(!0);try{const x=A.post("/auth/logout");w.success("Loged Out"),s("/authpage"),O(""),localStorage.clear(),j(!1),C("")}catch(x){w.error(((a=(n=x==null?void 0:x.response)==null?void 0:n.data)==null?void 0:a.message)||x.message),j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{className:"   bg-zinc-700 text-zinc-50 ",children:[e.jsx(fe,{children:e.jsx(se,{className:" bg-transparent px-0 ",children:e.jsx(ke,{className:" text-zinc-100 size-8  font-bold "})})}),e.jsxs(je,{itemClasses:{base:["data-[hover=true]:bg-zinc-800 data-[hover=true]:text-zinc-100 "]},className:" bg-zinc-700 ","aria-label":"Static Actions",children:[e.jsx(q,{onPress:()=>{l(),G(!0)},endContent:e.jsx(ve,{}),children:"Create group"},"group"),e.jsx(q,{onPress:()=>{l(),G(!1)},endContent:e.jsx(ae,{}),children:"Search user"},"search"),e.jsx(q,{className:" bg-zinc-500",onClick:H,endContent:e.jsx(Ge,{}),children:f?"Signing out":"sign out"})]})]}),U?e.jsx(D,{classNames:{closeButton:["hover:bg-transparent hover:text-white "],base:"bg-zinc-700 text-zinc-100 max-h-[400px] ",header:""},size:"sm",isOpen:r,onOpenChange:t,placement:"top",children:e.jsx(I,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col gap-1",children:"Create Group"}),e.jsxs($,{children:[e.jsx(W,{type:"text",required:!0,value:M,onChange:a=>P(a.target.value),classNames:{input:[" text-zinc-700 ","placeholder:text-zinc-400"]},placeholder:"Enter Group Name"}),e.jsx(W,{type:"text",required:!0,classNames:{input:[" text-zinc-700","placeholder:text-zinc-400"]},placeholder:"search user",value:o,onChange:a=>d(a.target.value)}),e.jsx("div",{className:" flex gap-2 flex-wrap  ",children:v&&v.length>=0&&v.map(a=>e.jsxs("span",{className:" text-xs p-1 bg-yellow-600 flex rounded-md items-center text-white gap-2 ",children:[a.name,e.jsx(Ne,{onClick:()=>F(a),className:" font-bold cursor-pointer "})]},a._id))}),e.jsxs("div",{className:"flex flex-col gap-2",children:[p!=""&&e.jsx("p",{className:" text-blue-200 text-sm text-center ",children:p.includes("search is required")?"*Search to add user":p}),f&&e.jsx(te,{color:"default"}),!f&&p==""&&c&&c.map(a=>e.jsx(Ae,{user:a,handlselected:()=>V(a)},a._id))]})]}),e.jsx(J,{children:e.jsx(se,{className:"bg-zinc-100 hover:bg-zinc-300 ",onPress:E,children:f?"creating":" Create"})})]})})}):e.jsx(D,{classNames:{closeButton:["hover:bg-transparent hover:text-white"],base:"bg-zinc-700 text-zinc-100 max-h-[400px] ",header:""},size:"xs",placement:"top",isOpen:r,onOpenChange:t,children:e.jsx(I,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col gap-1 mx-5  ",children:e.jsx(W,{type:"text",value:o,onChange:n=>d(n.target.value),placeholder:"Search User , group...",labelPlacement:"outside",classNames:{input:[" text-zinc-700 ","placeholder:text-zinc-400"],inputWrapper:["group-data-[focus=true]:bg-zinc-200"]},endContent:e.jsx(ae,{className:"text-2xl text-zinc-700 pointer-events-none flex-shrink-0"})})}),e.jsxs($,{className:"overflow-y-scroll scrollbar-hide",children:[p!=""&&e.jsx("p",{className:" text-blue-200 text-sm text-center ",children:p.includes("search is required")?"*Search user":p}),f&&e.jsx(te,{color:"default"}),!f&&p==""&&c&&c.map(n=>e.jsx(Me,{user:n,CreateChat:Y},n._id))]}),e.jsx(J,{})]})})})]})},Pe=({chat:s})=>{var m,c,h,o;const r=R(Q),l=re(K),t=Ce(s.members,r);return e.jsx(e.Fragment,{children:s.isGroupChat?e.jsxs("div",{onClick:()=>l(s),className:" flex hover:scale-105 transition-all   rounded-2xl  cursor-pointer   mx-8  items-center  p-1 mb-3 sm:mx-0 md:mx-2 bg-zinc-200  text-zinc-800  gap-2 ",children:[e.jsx(g,{className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10",src:s.Chaticon||"https://user-images.githubusercontent.com/1468166/37978116-46efb0e0-31b3-11e8-8d51-8d7af47d6f1c.png"}),e.jsxs("div",{className:" flex flex-col ",children:[e.jsx("span",{className:" font-semibold  sm:text-xs md:text-sm ",children:s.ChatName}),e.jsxs("div",{className:"flex gap-1 items-center ",children:[e.jsxs("p",{className:" sm:text-sm text-xs font-semibold  ",children:[(c=(m=s.latestMessage)==null?void 0:m.sender)==null?void 0:c.name," :"]}),s.latestMessage==null?e.jsx("p",{className:"sm:text-sm  text-xs",children:"select a chat to start conversation"}):e.jsx("p",{className:"sm:text-sm  text-xs",children:s.latestMessage.content})]})]})]}):e.jsxs("div",{onClick:()=>l(s),className:" flex hover:scale-105 transition-all  rounded-2xl cursor-pointer    mx-8  items-center  p-1 mb-3 sm:mx-0 md:mx-2 bg-zinc-200  text-zinc-800  gap-2 ",children:[e.jsx(g,{className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10",src:(t==null?void 0:t.profilepic)||"https://i.pravatar.cc/150?u=a042581f4e29026024d"}),e.jsxs("div",{className:" flex flex-col ",children:[e.jsx("span",{className:" font-bold  sm:text-xs md:text-sm ",children:t==null?void 0:t.name}),e.jsxs("div",{className:"flex gap-1 items-center ",children:[e.jsx("p",{className:" sm:text-sm text-xs font-semibold  ",children:(o=(h=s.latestMessage)==null?void 0:h.sender)==null?void 0:o.name}),s.latestMessage==null?e.jsx("p",{className:"sm:text-sm  text-xs",children:"select a chat to start conversation"}):e.jsx("p",{className:"sm:text-sm  text-xs",children:s.latestMessage.content})]})]})]})})};function Fe(s){return B({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 21a6 6 0 0 0-12 0"},child:[]},{tag:"circle",attr:{cx:"12",cy:"11",r:"4"},child:[]},{tag:"rect",attr:{width:"18",height:"18",x:"3",y:"3",rx:"2"},child:[]}]})(s)}const Re=()=>{const{isOpen:s,onOpen:r,onOpenChange:l}=ne(),t=R(Q);return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{onClick:r,className:" text-[30px] text-white  cursor-pointer "}),e.jsx(D,{size:"sm",classNames:{closeButton:["hover:bg-transparent hover:text-zinc-200"],base:["bg-zinc-800"]},isOpen:s,onOpenChange:l,children:e.jsx(I,{children:m=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col  gap-1"}),e.jsx($,{className:" p-5  flex items-center justify-center ",children:e.jsxs("div",{className:" flex  flex-col items-center justify-center ",children:[e.jsx(g,{className:" h-[200px] w-[200px]  ",src:t==null?void 0:t.profilepic}),e.jsxs("div",{className:" text-center text-zinc-100 mt-4 ",children:[e.jsx("h3",{children:t==null?void 0:t.name}),e.jsx("h4",{children:t==null?void 0:t.email})]})]})}),e.jsx(J,{})]})})})]})},Oe=()=>{const[s,r]=Z(le),l=R(be),t=R(K),m=async()=>{var c,h,o;try{const d=await A.get("/chat/getChats");r((c=d.data)==null?void 0:c.data),console.log(s)}catch(d){w.error(((o=(h=d==null?void 0:d.response)==null?void 0:h.data)==null?void 0:o.message)||"something went wrong")}};return u.useEffect(()=>{m()},[l]),e.jsxs("section",{className:`h-screen  sm:block ${t?"hidden":"block"} bg-zinc-900  border-gray-200  `,children:[e.jsxs("div",{className:" sm:mx-3 mx-1 flex  h-[100px]   bg-zinc-900  justify-between  items-center p-3 ",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Se,{}),e.jsx("h4",{className:"text-white  px-4  font-semibold font-sans tracking-in-expand ",children:"SENT"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Re,{}),e.jsx(Le,{})]})]}),e.jsxs("div",{className:" p-4  w-full border-green-500  h-full ",children:[s.length>0&&s.map(c=>e.jsx(Pe,{chat:c},c._id)),s.length==0&&e.jsx("div",{className:" flex  items-center justify-center  h-[50%]   ",children:e.jsx(_e,{placement:"top",content:"Select a user to start chat by searching from menu  ",className:" m-3 ",children:e.jsxs(ye,{isBordered:!0,max:6,className:" m-3  cursor-pointer",children:[e.jsx(g,{src:"https://i.pravatar.cc/150?u=a042581f4e29026024d"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a04258a2462d826712d"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a042581f4e29026704d"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a04258114e29026302d"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a04258114e29026702d"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a04258114e29026708c"}),e.jsx(g,{src:"https://i.pravatar.cc/150?u=a04258114e29026708c"})]})})})]})]})};export{Oe as default};
